---
title: 发布订阅
date: 2020-11-18 09:37:56
tags: redis
categories: redis
---
## 角色

- 发布者（publisher）
- 订阅者（subscriber）
- 频道（channel）

## 模型

{% asset_img 发布订阅模型.png 发布订阅模型%}

没有消息堆积的功能，无法查询历史发布消息

## API

### publish（发布命令）

```sql
publish  channel message

127.0.0.1:6379> publish sohu:tv "hello world"
(integer) 0 # 订阅者个数
```

### subcribe（订阅）

```sql
subscribe [channel] # 一个或多个

127.0.0.1:6379> subscribe sohu:tv
Reading messages... (press Ctrl-C to quit)
1) "subscribe"
2) "sohu:tv"
3) (integer) 1
```

### unsubcribe（取消订阅）

```sql
unsubscribe [channel] # 一个或多个

127.0.0.1:6379> unsubscribe sohu:tv
1) "unsubscribe"
2) "sohu:tv"
3) (integer) 0
```

### 其他API

1. osubscribe [pattern ...] # 订阅模式
2. punsubscribe [pattern ...] # 退订指定的模式
3. pubsub channels # 列出至少有一个订阅者的频道
4. pubsub numsub [channel ...] # 列出给定频道的订阅者数量
5. pubsub numpat # 列出被订阅模式的数量

## 消息队列

{% asset_img 消息队列.png 消息队列%}