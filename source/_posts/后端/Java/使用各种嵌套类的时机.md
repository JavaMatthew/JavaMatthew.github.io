---
title: 使用各种嵌套类的时机
date: 2020-07-31 11:11:04
tags: Java
categories: [Java,Java SE]
---
## 嵌套类（nested class）

> 嵌套类是指被定义在另一个类内部的类

嵌套类的分类：

1. 静态成员类（static member class）
2. 非静态成员类（nonstatic member class）
3. 匿名类（anonymous class）
4. 局部类（local class）

除了第一种之外，其他三种被称为内部类（inner class）

## 静态成员类用法

> 常见的用法是作为公有的辅助类，仅当与它的外部类一起使用时才有意义。

例如：考虑一个枚举类，它描述了计算机支持的各种操作。Operation枚举应该时Calculator类的公有静态成员类，然后，Calculator类的客户端就可以用诸如`Calculator.Operation.PLUS`和`Calculator.Operation.MINUS`这样的名称来引用 这些操作。

## 非静态成员类用法

> 常见的用法时定义一个Adapter，它允许外部类的实例被看作时另一个不相关的类的实例。

例如：Map接口的是西安往往 使用非静态成员类来实现他们的集合试图（collection view），这些集合视图时由Map的keySet、entrySet和Values方法返回的。同样诸如Set和List这种集合接口的实现往往也是使用非静态成员类 来实现他们的迭代器（iterator）

**如果声明成员类不要求访问外围实例，就要始终把static修饰符放在它的声明中，使他成为静态成员类，而不是非静态成员类。**如果省略了static修饰符，则每个实例都将包含一个额外的指向外围对象的引用。保存这份引用要消耗时间和空间，并且会导致外围实例在符合垃圾回收时却仍然得以保留。如果在没有外围实例的情况下，也需要分配实例，就不能使用非静态成员类，因为非静态成员类的实例必须要有一个外围实例。

## 匿名类用法

> 匿名类可以出现在代码中任何允许存在表达式的地方。常见的用法时动态地创建函数对象、过程对象、静态工厂方法的内部。

例如：Comparator(函数对象)，Runnable(过程对象)，new AbstractList{@Override...}(静态工厂方法的内部)

## 局部类用法

> 局部类时四种嵌套类中 用的最少的类。在任何“可以声明局部变量”的地方，都可以声明局部类，并且局部类也遵守同样的作用域规则。

总之如果一个嵌套类需要在单个方法之外仍然是可见的，或者它太长了，不适合于放在方法内部，就应该使用成员类。如果成员类的每个实例都需要一个只想其外围实例的引用，就要把成员类做成非静态的否则就做成静态的。
假设这个嵌套类属于一个方法的内部，如果你只需要在一个地方创建实例。并且已经有了一个预置的类型可以说明这个类的特征，就要把它做成匿名类；否则就做成局部类。

