---
title: 缓冲区的数据存取
p: 后端/Java/Java8新特性/NIO/缓冲区的的数据存取
date: 2019-12-20 10:57:39
tags: Java
categories: [Java,Java8新特性,NIO]
---
## 缓冲区（buffer）的数据存取

- 缓冲区（Buffer）：一个用于特定基本数据类型的容器。由 java.nio 包定义的，所有缓冲区都是 Buffer 抽象类的子类。
- Java NIO 中的 Buffer 主要用于与 NIO 通道进行交互，数据是从通道读入缓冲区，从缓冲区写入通道中的。

缓冲区（Buffer）：在Java NIO中负责数据的 存取。缓冲区就是数组，用于存储不同数据类型的数据

根据数据类型不同（boolean除外），提供了相应类型的缓冲区：

- ByteBuffer
- CharBuffer
- ShortBuffer
- IntBuffer
- LongBuffer
- FloatBuffer
- DoubleBuffer

上述缓冲区的管理方式几乎一致，通过allocate()获取缓存区。`static XxxBuffer allocate(int capacity)` : 创建一个容量为 capacity 的 XxxBuffer 对象

## 缓冲区的基本属性

Buffer 中的重要概念：

- 容量 (capacity) ：表示 Buffer 最大数据容量，缓冲区容量不能为负，并且创建后不能更改。
- 限制 (limit)：第一个不应该读取或写入的数据的索引，即位于 limit 后的数据不可读写。缓冲区的限制不能为负，并且不能大于其容量。
- 位置 (position)：下一个要读取或写入的数据的索引。缓冲区的位置不能为负，并且不能大于其限制
- 标记 (mark)与重置 (reset)：标记是一个索引，通过 Buffer 中的 mark() 方法指定 Buffer 中一个特定的 position，之后可以通过调用 reset() 方法恢复到这个 position.
`标记、位置、限制、容量遵守以下不变式： 0 <= mark <= position <= limit <= capacity`
{% asset_img buffer.png buffer%}

## Buffer 的常用方法

|方 法 | 描 述|
|--|--|
|Buffer clear()| 清空缓冲区并返回对缓冲区的引用|
|Buffer flip() |将缓冲区的界限设置为当前位置，并将当前位置充值为 0|
|int capacity() |返回 Buffer 的 capacity 大小|
|boolean hasRemaining()| 判断缓冲区中是否还有元素|
|int limit()| 返回 Buffer 的界限(limit) 的位置|
|Buffer limit(int n) |将设置缓冲区界限为 n, 并返回一个具有新 limit 的缓冲区对象|
|Buffer mark()| 对缓冲区设置标记|
|int position()| 返回缓冲区的当前位置 position|
|Buffer position(int n)| 将设置缓冲区的当前位置为 n , 并返回修改后的 Buffer 对象|
|int remaining() |返回 position 和 limit 之间的元素个数|
|Buffer reset() |将位置 position 转到以前设置的 mark 所在的位置|
|Buffer rewind() |将位置设为为 0， 取消设置的 mark|
