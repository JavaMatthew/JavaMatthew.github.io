---
layout: 线程安全
title: 线程安全
date: 2019-12-18 09:36:26
tags: Java
categories: [Java,JUC线程]
---

## 创建线程的方式

1. 继承Thread
2. 实现Runnable
3. 实现Callable
    一、相较于实现Runnable接口的方式，方法可以有返回值，并且可以抛出异常。
    二、执行Callable方式，需要FutureTask实现类的支持，用于接收运算结果。FutureTask是Futrue接口的实现类
4. 通过线程池声明

## Lock同步锁

1. 用于解决多线程安全问题的范式：
    synchronized：隐式锁
    1. 同步代码块
    2. 同步方法
    jdk1.5后：
    3. 同步锁Lock
        注意：是一个显示锁，需要通过lock()方法上锁，必须通过unlock()方法进行释放锁

注意：
在可能出现线程异常的地方要把释放锁放在finally中

```java
class Ticket implements Runnable {

    private int tick = 100;

    private Lock lock = new ReentrantLock();

    @Override
    public void run() {
        while (true) {
            lock.lock();
            try{
                if (tick > 0) {
                    try {
                        Thread.sleep(200);
                        System.out.println(Thread.currentThread().getName() + " 完成售票，余票为： " + --tick);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }else {
                    break;
                }
            }finally {
                lock.unlock();
            }
        }
    }
}
```
